Кратко порядок действий:
1.  Собрать `dataset_raw`.
2.  Run `1_prepare_dataset.py`.
3.  Run `2_train_model.py`.
4.  Скопировать `best.pt` -> `models/`.
5.  Run `3_run_pipeline.py`.

---

#### 1. Подготовка папки
1.  **`dataset_raw`**
2.  Скопируй туда **от 50 до 100 фотографий с объектами класса**.
*   5-10 шт: на светлом фоне.
*   5-10 шт: на темном/пестром фоне.
*   5-10 шт: крупная.
*   5-10 шт: мелкая.
*   5-10 шт: вертикальные/под наклоном.
*   Остальные: случайные.

#### 2. Настройка LabelImg
0.  Скачай LabelImg (https://github.com/HumanSignal/labelImg/releases/tag/v1.8.1)
1.  Запусти `labelImg.exe`.
2.  Слева нажми кнопку **"Open Dir"** и выбери папку `dataset_raw`.
3.  Слева нажми кнопку **"Change Save Dir"** и выбери **ТУ ЖЕ САМУЮ** папку `dataset_raw`. (Файлы с координатами будут падать рядом с картинками).
4.  **ГЛАВНЫЙ МОМЕНТ:** Посмотри на панель слева, под кнопкой "Save". Там написано **PascalVOC**?
    *   Нажми на эту кнопку **один раз**. Надпись должна смениться на **YOLO**. Нам нужно YOLO

#### 3. Процесс разметки 

1.  Если картинка загрузилась, нажми клавишу **`W`** (появится перекрестие).
2.  Зажми левую кнопку мыши и нарисуй прямоугольник вокруг объекта класса.
    *   *Совет:* Не делай слишком большие отступы.
3.  Откроется окошко ввода. Напиши: что-то типа **`your_class_object_name`**.
    *   Нажми OK.
4.  Нажми **`Ctrl + S`** (Сохранить).
5.  Нажми **`D`** (Следующая картинка).

Повторяй, пока не закончишь.
*   Если на фото 2 объекта класса — выделяй оба.

#### Как проверить, что всё идет правильно?
Зайди в папку `dataset_raw` через проводник Windows.
После сохранения первой картинки там должен появиться файл `classes.txt` и файл вида `image_01.txt`.
Открой `image_01.txt` блокнотом. Там должны быть цифры, например:
`0 0.453 0.123 0.05 0.10`
(Это значит: Класс №0, Координата X, Y, Ширина, Высота).

---


### Порядок действий после разметки:

1.  В папке `dataset_raw` должны быть картинки и `txt` файлы (через LabelImg).
2.  **Подготовка:** Запусти `1_prepare_dataset.py`.
    *   *Проверка:* Появится папка `datasets/prepared`.
3.  **Обучение:** Запусти `2_train_model.py`.
    *   *Проверка:* В консоли побегут строки с процентами. Компьютер зашумит вентиляторами. Минут через 10-15 он закончит.

Когда обучение закончится, зайди в папку runs/detect/your_class. Там лежит файл results.csv — Таблица Excel со всеми цифрами по эпохам.

---

### Удаление размеченного класса

**Твой финальный чек-лист:**

1.  **Разметка:** Ты разметил фото, запустил `1_prepare_dataset.py`, затем `2_train_model.py`.
2.  **Перенос Модели:**
    *   Зайди в папку `runs/detect/your_class/weights/`.
    *   Найди файл `best.pt`.
    *   **Скопируй** его в папку `models/` (в корне проекта).

    (копирование выполняется вручную, чтобы случайно не перезаписать другие результаты дообучения)

3. **Входные данные:**
    *   Положи все свои фото (или для теста сначала 10 штук) в папку `images_input`.
4.  **ЗАПУСК:**
    *   Запусти `3_run_pipeline.py`.

При первом запуске он может пару минут качать SAM и LaMa. Потом полетит полоска прогресса.


#### Проверка места на диске
*   Все фото могут весить много.
*   Скрипт создает **копии** (в папке `images_cleaned`).
*   **Убедись**, что у тебя достаточно места на диске (примерно столько, сколько весит папка с картинками).