–ö—Ä–∞—Ç–∫–æ –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π:
1.  –°–æ–±—Ä–∞—Ç—å `dataset_raw`.
2.  Run `1_prepare_dataset.py`.
3.  Run `2_train_model.py`.
4.  –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å `best.pt` -> `models/`.
5.  Run `3_run_pipeline.py`.

---

#### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–∞–ø–∫–∏
1.  **`dataset_raw`**
2.  –°–∫–æ–ø–∏—Ä—É–π —Ç—É–¥–∞ **–æ—Ç 50 –¥–æ 100 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –∫–ª–∞—Å—Å–∞**.
*   5-10 —à—Ç: –Ω–∞ —Å–≤–µ—Ç–ª–æ–º —Ñ–æ–Ω–µ.
*   5-10 —à—Ç: –Ω–∞ —Ç–µ–º–Ω–æ–º/–ø–µ—Å—Ç—Ä–æ–º —Ñ–æ–Ω–µ.
*   5-10 —à—Ç: –∫—Ä—É–ø–Ω–∞—è.
*   5-10 —à—Ç: –º–µ–ª–∫–∞—è.
*   5-10 —à—Ç: –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ/–ø–æ–¥ –Ω–∞–∫–ª–æ–Ω–æ–º.
*   –û—Å—Ç–∞–ª—å–Ω—ã–µ: —Å–ª—É—á–∞–π–Ω—ã–µ.

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LabelImg
0.  –°–∫–∞—á–∞–π LabelImg (https://github.com/HumanSignal/labelImg/releases/tag/v1.8.1)
1.  –ó–∞–ø—É—Å—Ç–∏ `labelImg.exe`.
2.  –°–ª–µ–≤–∞ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É **"Open Dir"** –∏ –≤—ã–±–µ—Ä–∏ –ø–∞–ø–∫—É `dataset_raw`.
3.  –°–ª–µ–≤–∞ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É **"Change Save Dir"** –∏ –≤—ã–±–µ—Ä–∏ **–¢–£ –ñ–ï –°–ê–ú–£–Æ** –ø–∞–ø–∫—É `dataset_raw`. (–§–∞–π–ª—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –±—É–¥—É—Ç –ø–∞–¥–∞—Ç—å —Ä—è–¥–æ–º —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏).
4.  **–ì–õ–ê–í–ù–´–ô –ú–û–ú–ï–ù–¢:** –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –ø–∞–Ω–µ–ª—å —Å–ª–µ–≤–∞, –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π "Save". –¢–∞–º –Ω–∞–ø–∏—Å–∞–Ω–æ **PascalVOC**?
    *   –ù–∞–∂–º–∏ –Ω–∞ —ç—Ç—É –∫–Ω–æ–ø–∫—É **–æ–¥–∏–Ω —Ä–∞–∑**. –ù–∞–¥–ø–∏—Å—å –¥–æ–ª–∂–Ω–∞ —Å–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ **YOLO**. –ù–∞–º –Ω—É–∂–Ω–æ YOLO

#### 3. –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–º–µ—Ç–∫–∏ 

1.  –ï—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å, –Ω–∞–∂–º–∏ –∫–ª–∞–≤–∏—à—É **`W`** (–ø–æ—è–≤–∏—Ç—Å—è –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–∏–µ).
2.  –ó–∞–∂–º–∏ –ª–µ–≤—É—é –∫–Ω–æ–ø–∫—É –º—ã—à–∏ –∏ –Ω–∞—Ä–∏—Å—É–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –≤–æ–∫—Ä—É–≥ –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞—Å—Å–∞.
    *   *–°–æ–≤–µ—Ç:* –ù–µ –¥–µ–ª–∞–π —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –æ—Ç—Å—Ç—É–ø—ã.
3.  –û—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–æ—à–∫–æ –≤–≤–æ–¥–∞. –ù–∞–ø–∏—à–∏: —á—Ç–æ-—Ç–æ —Ç–∏–ø–∞ **`your_class_object_name`**.
    *   –ù–∞–∂–º–∏ OK.
4.  –ù–∞–∂–º–∏ **`Ctrl + S`** (–°–æ—Ö—Ä–∞–Ω–∏—Ç—å).
5.  –ù–∞–∂–º–∏ **`D`** (–°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞).

–ü–æ–≤—Ç–æ—Ä—è–π, –ø–æ–∫–∞ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—à—å.
*   –ï—Å–ª–∏ –Ω–∞ —Ñ–æ—Ç–æ 2 –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞—Å—Å–∞ ‚Äî –≤—ã–¥–µ–ª—è–π –æ–±–∞.

#### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë –∏–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ?
–ó–∞–π–¥–∏ –≤ –ø–∞–ø–∫—É `dataset_raw` —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫ Windows.
–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–∞–º –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Ñ–∞–π–ª `classes.txt` –∏ —Ñ–∞–π–ª –≤–∏–¥–∞ `image_01.txt`.
–û—Ç–∫—Ä–æ–π `image_01.txt` –±–ª–æ–∫–Ω–æ—Ç–æ–º. –¢–∞–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ü–∏—Ñ—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:
`0 0.453 0.123 0.05 0.10`
(–≠—Ç–æ –∑–Ω–∞—á–∏—Ç: –ö–ª–∞—Å—Å ‚Ññ0, –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X, Y, –®–∏—Ä–∏–Ω–∞, –í—ã—Å–æ—Ç–∞).

---


### –ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ—Å–ª–µ —Ä–∞–∑–º–µ—Ç–∫–∏:

1.  –í –ø–∞–ø–∫–µ `dataset_raw` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏ `txt` —Ñ–∞–π–ª—ã (—á–µ—Ä–µ–∑ LabelImg).
2.  **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:** –ó–∞–ø—É—Å—Ç–∏ `1_prepare_dataset.py`.
    *   *–ü—Ä–æ–≤–µ—Ä–∫–∞:* –ü–æ—è–≤–∏—Ç—Å—è –ø–∞–ø–∫–∞ `datasets/prepared`.
3.  **–û–±—É—á–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏ `2_train_model.py`.
    *   *–ü—Ä–æ–≤–µ—Ä–∫–∞:* –í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ–±–µ–≥—É—Ç —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏. –ö–æ–º–ø—å—é—Ç–µ—Ä –∑–∞—à—É–º–∏—Ç –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞–º–∏. –ú–∏–Ω—É—Ç —á–µ—Ä–µ–∑ 10-15 –æ–Ω –∑–∞–∫–æ–Ω—á–∏—Ç.

### –°–º–æ—Ç—Ä–∏–º –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

1.  **–ù–ï –∑–∞–∫—Ä—ã–≤–∞–π** –∏ **–ù–ï –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π** —Ç–µ—Ä–º–∏–Ω–∞–ª, –≥–¥–µ –∏–¥–µ—Ç –æ–±—É—á–µ–Ω–∏–µ.
2.  –û—Ç–∫—Ä–æ–π **–Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Ç–µ—Ä–º–∏–Ω–∞–ª–∞**.
3.  –í–≤–µ–¥–∏ –∫–æ–º–∞–Ω–¥—É:
    ```bash
    tensorboard --logdir runs/detect
    ```
4.  –û–Ω –Ω–∞–ø–∏—à–µ—Ç —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:
    `TensorBoard 2.20.0 at http://localhost:6006/ (Press CTRL+C to quit)`
5. –ù–∞–∂–º–∏ –Ω–∞ —ç—Ç—É —Å—Å—ã–ª–∫—É (http://localhost:6006/) –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π –µ—ë –≤ –±—Ä–∞—É–∑–µ—Ä.

**–ß—Ç–æ —Ç—ã —É–≤–∏–¥–∏—à—å:**
–ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å–∞–º–∏.
*   –ò—â–∏ –≤–∫–ª–∞–¥–∫—É **SCALARS**.
*   –ì—Ä–∞—Ñ–∏–∫ **`metrics/mAP50(B)`** ‚Äî —ç—Ç–æ —Ç–≤–æ—è —Ç–æ—á–Ω–æ—Å—Ç—å. –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–ª–∑—Ç–∏ **–≤–≤–µ—Ä—Ö** üìà.
*   –ì—Ä–∞—Ñ–∏–∫ **`train/box_loss`** ‚Äî —ç—Ç–æ –æ—à–∏–±–∫–∞. –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø–∞–¥–∞—Ç—å **–≤–Ω–∏–∑** üìâ.


–ö–æ–≥–¥–∞ –æ–±—É—á–µ–Ω–∏–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è, –∑–∞–π–¥–∏ –≤ –ø–∞–ø–∫—É:

üìÇ runs/detect/your_class
–¢–∞–º –ª–µ–∂–∞—Ç —Ñ–∞–π–ª—ã:

üìä results.png ‚Äî –°–∞–º—ã–π –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª. –¢–∞–º —Å–æ–±—Ä–∞–Ω—ã –≤—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ (–ø–æ—Ç–µ—Ä–∏, —Ç–æ—á–Ω–æ—Å—Ç—å) –Ω–∞ –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–µ.

üñº val_batch0_labels.jpg ‚Äî –≠—Ç–æ "–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã" (–∫–∞–∫ —Ç—ã —Ä–∞–∑–º–µ—Ç–∏–ª).

üñº val_batch0_pred.jpg ‚Äî –≠—Ç–æ "–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏" (—á—Ç–æ –æ–Ω–∞ –Ω–∞—à–ª–∞ —Å–∞–º–∞).

–°—Ä–∞–≤–Ω–∏ —ç—Ç–∏ –¥–≤–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏. –ï—Å–ª–∏ –Ω–∞ pred.jpg –∫–≤–∞–¥—Ä–∞—Ç—ã —Ç–∞–º –∂–µ, –≥–¥–µ –Ω–∞ labels.jpg ‚Äî –Ω–µ–π—Ä–æ—Å–µ—Ç—å –æ–±—É—á–∏–ª–∞—Å—å!

üìâ results.csv ‚Äî –¢–∞–±–ª–∏—Ü–∞ Excel —Å–æ –≤—Å–µ–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏ –ø–æ —ç–ø–æ—Ö–∞–º.

---

### –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—á–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞

**–¢–≤–æ–π —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç:**

1.  **–†–∞–∑–º–µ—Ç–∫–∞:** –¢—ã —Ä–∞–∑–º–µ—Ç–∏–ª —Ñ–æ—Ç–æ, –∑–∞–ø—É—Å—Ç–∏–ª `1_prepare_dataset.py`, –∑–∞—Ç–µ–º `2_train_model.py`.
2.  **–ü–µ—Ä–µ–Ω–æ—Å –ú–æ–¥–µ–ª–∏:**
    *   –ó–∞–π–¥–∏ –≤ –ø–∞–ø–∫—É `runs/detect/your_class/weights/`.
    *   –ù–∞–π–¥–∏ —Ñ–∞–π–ª `best.pt`.
    *   **–°–∫–æ–ø–∏—Ä—É–π** –µ–≥–æ –≤ –ø–∞–ø–∫—É `models/` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞).

    (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é, —á—Ç–æ–±—ã —Å–ª—É—á–∞–π–Ω–æ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–æ–±—É—á–µ–Ω–∏—è)

3. **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
    *   –ü–æ–ª–æ–∂–∏ –≤—Å–µ —Å–≤–æ–∏ —Ñ–æ—Ç–æ (–∏–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–∞ —Å–Ω–∞—á–∞–ª–∞ 10 —à—Ç—É–∫) –≤ –ø–∞–ø–∫—É `images_input`.
4.  **–ó–ê–ü–£–°–ö:**
    *   –ó–∞–ø—É—Å—Ç–∏ `3_run_pipeline.py`.

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –æ–Ω –º–æ–∂–µ—Ç –ø–∞—Ä—É –º–∏–Ω—É—Ç –∫–∞—á–∞—Ç—å SAM –∏ LaMa. –ü–æ—Ç–æ–º –ø–æ–ª–µ—Ç–∏—Ç –ø–æ–ª–æ—Å–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.


#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
*   –í—Å–µ —Ñ–æ—Ç–æ –º–æ–≥—É—Ç –≤–µ—Å–∏—Ç—å –º–Ω–æ–≥–æ.
*   –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç **–∫–æ–ø–∏–∏** (–≤ –ø–∞–ø–∫–µ `images_cleaned`).
*   **–£–±–µ–¥–∏—Å—å**, —á—Ç–æ —É —Ç–µ–±—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (–ø—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –≤–µ—Å–∏—Ç –ø–∞–ø–∫–∞ —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏).