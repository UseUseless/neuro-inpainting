"""
–ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞.
"""

import torch
from pathlib import Path

# ==============================================================================
# üìÇ 1. –ü–£–¢–ò –ò –ò–°–¢–û–ß–ù–ò–ö–ò
# ==============================================================================
BASE_DIR = Path(__file__).parent

# –†–∞–±–æ—á–∏–µ –ø–∞–ø–∫–∏
INPUT_DIR = BASE_DIR / "images_input"       # –¢–≤–æ–∏ —Ñ–æ—Ç–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
OUTPUT_DIR = BASE_DIR / "images_cleaned"    # –†–µ–∑—É–ª—å—Ç–∞—Ç
LOG_DIR = BASE_DIR / "logs"                 # –õ–æ–≥–∏
MODELS_DIR = BASE_DIR / "models"            # –í–µ—Å–∞ –º–æ–¥–µ–ª–µ–π
TEMP_DIR = BASE_DIR / "temp_download"       # –í—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–ø–∫–∞

# –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
TRAIN_DATASET_DIR = BASE_DIR / "train_dataset"
BACKGROUNDS_DIR = BASE_DIR / "backgrounds"
BACKGROUNDS_URL = "http://images.cocodataset.org/zips/val2017.zip"

# –§–∞–π–ª –≤–∞—Ç–µ—Ä–º–∞—Ä–∫–∏ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û PNG —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é)
WATERMARK_SOURCE = BASE_DIR / "watermark.png"

# ==============================================================================
# üé® 2. –ù–ê–°–¢–†–û–ô–ö–ò –ì–ï–ù–ï–†–ê–¢–û–†–ê (SYNTHETIC DATA)
# ==============================================================================

# --- –õ–û–ì–ò–ö–ê –û–ë–™–ï–ú–ê ---
# –°–∫—Ä–∏–ø—Ç –≤–æ–∑—å–º–µ—Ç 100% —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–∞–ø–∫–∏ backgrounds.
# –ò –¥–æ–±–∞–≤–∏—Ç –∫ –Ω–∏–º —Å–≤–µ—Ä—Ö—É –µ—â–µ N% —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.
GEN_EXTRA_SOLID_PERCENT = 0.20  # +20% –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (–µ—Å–ª–∏ —Ñ–æ–Ω–æ–≤ 5000, –¥–æ–±–∞–≤–∏—Ç 1000)

GEN_TRAIN_RATIO = 0.8           # 80% –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ, 20% –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É

# --- –í–ï–†–û–Ø–¢–ù–û–°–¢–ò –°–¶–ï–ù–ê–†–ò–ï–í –î–õ–Ø –ö–ê–ñ–î–û–ì–û –§–û–¢–û ---
GEN_PROB_NEGATIVE = 0.05        # 5% –ø—É—Å—Ç—ã—Ö —Ñ–æ—Ç–æ (–±–µ–∑ –≤–∞—Ç–µ—Ä–º–∞—Ä–∫–∏), —á—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
GEN_PROB_EASY_MODE = 0.20       # 20% "–õ–µ–≥–∫–∏—Ö" –ø—Ä–∏–º–µ—Ä–æ–≤ (—á–µ—Ç–∫–∏–µ, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–µ, –∫–∞–∫ –Ω–∞ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ)
GEN_PROB_EDGE_CORRUPTION = 0.50 # 50% –®–∞–Ω—Å –∏—Å–ø–æ—Ä—Ç–∏—Ç—å –∫—Ä–∞—è (–∏–º–∏—Ç–∞—Ü–∏—è "–ª–µ—Å–µ–Ω–∫–∏" –∏ –ø–ª–æ—Ö–æ–≥–æ –≤—ã—Ä–µ–∑–∞–Ω–∏—è)

# --- –ì–ï–û–ú–ï–¢–†–ò–Ø ---
GEN_SCALE_RANGE = (0.15, 0.85)  # –†–∞–∑–º–µ—Ä –≤–∞—Ç–µ—Ä–º–∞—Ä–∫–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —à–∏—Ä–∏–Ω—ã —Ñ–æ–Ω–∞ (–æ—Ç 15% –¥–æ 85%)
GEN_ROTATION_PROB = 0.5         # 50% —à–∞–Ω—Å –ø–æ–≤–æ—Ä–æ—Ç–∞ –Ω–∞ 90 –≥—Ä–∞–¥—É—Å–æ–≤

# --- –ò–°–ö–ê–ñ–ï–ù–ò–Ø (–î–ª—è Hard Mode) ---
GEN_OPACITY_RANGE = (0.05, 0.95)# –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –æ—Ç 5% (–µ–ª–µ –≤–∏–¥–Ω–æ) –¥–æ 95% (–ø–æ—á—Ç–∏ –∫–∏—Ä–ø–∏—á)
GEN_INVERT_PROB = 0.3           # 30% —à–∞–Ω—Å –∏–Ω–≤–µ—Ä—Å–∏–∏ —Ü–≤–µ—Ç–∞ (–ß–µ—Ä–Ω—ã–π <-> –ë–µ–ª—ã–π)
GEN_BLUR_PROB = 0.5             # 50% —à–∞–Ω—Å —Ä–∞–∑–º—ã—Ç–∏—è (–∏–º–∏—Ç–∞—Ü–∏—è —Ä–∞—Å—Ñ–æ–∫—É—Å–∞)
GEN_COLOR_PROB = 0.3            # 30% —à–∞–Ω—Å –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è –≤ —Å–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç (–∏–≥–Ω–æ—Ä —Ü–≤–µ—Ç–∞)

# --- –õ–ï–ß–ï–ù–ò–ï –ò–°–•–û–î–ù–ò–ö–ê ---
# –†–∞—Å—à–∏—Ä–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π PNG –Ω–∞ X –ø–∏–∫—Å–µ–ª–µ–π –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π.
# 0 = –ù–µ —Ç—Ä–æ–≥–∞—Ç—å (–µ—Å–ª–∏ –≤—ã—Ä–µ–∑–∞–ª –∏–¥–µ–∞–ª—å–Ω–æ).
# 2-3 = –ï—Å–ª–∏ –∫—Ä–∞—è —Ä–≤–∞–Ω—ã–µ –∏–ª–∏ —Ç–æ–Ω–∫–∏–µ.
GEN_SOURCE_REPAIR_DILATION = 2

# ==============================================================================
# üèãÔ∏è 3. –ù–ê–°–¢–†–û–ô–ö–ò –û–ë–£–ß–ï–ù–ò–Ø (YOLO Training)
# ==============================================================================
TRAIN_EPOCHS = 200          # 100 —ç–ø–æ—Ö - —Å—Ç–∞–Ω–¥–∞—Ä—Ç
TRAIN_IMG_SIZE = 640        # –†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç–∏–Ω–∫–∏
TRAIN_PATIENCE = 15         # –û—Å—Ç–∞–Ω–æ–≤–∫–∞, –µ—Å–ª–∏ 15 —ç–ø–æ—Ö –Ω–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π

TRAIN_BATCH = 8             # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞. –ï—Å–ª–∏ –≤—ã–ª–µ—Ç–∏—Ç –ø–∞–º—è—Ç—å -> —Å—Ç–∞–≤—å 2.
TRAIN_WORKERS = 0           # –î–ª—è Windows –≤—Å–µ–≥–¥–∞ 0

# –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É)
TRAIN_MOSAIC = 1.0          # –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω
TRAIN_HSV_H = 0.015         # –¢–æ–Ω
TRAIN_HSV_S = 0.7           # –ù–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å
TRAIN_HSV_V = 0.4           # –Ø—Ä–∫–æ—Å—Ç—å (–ø–æ–º–æ–≥–∞–µ—Ç –≤–∏–¥–µ—Ç—å –≤ —Ç–µ–º–Ω–æ—Ç–µ)
TRAIN_SCALE = 0.5           # –ó—É–º

# ==============================================================================
# üïµÔ∏è 4. –î–ï–¢–ï–ö–¢–û–† –ò –ü–ê–ô–ü–õ–ê–ô–ù
# ==============================================================================
# –ú–æ–¥–µ–ª—å
YOLO_MODEL_NAME = "yolo11s-seg.pt"          # small –≤–µ—Ä—Å–∏—è (–±—ã—Å—Ç—Ä–∞—è, –Ω–∞ –æ–¥–Ω—É –≤—ã—à–µ nano)
YOLO_MODEL_PATH = MODELS_DIR / "best.pt"    # –ü—É—Ç—å –∫ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
YOLO_CONFIDENCE = 0.15                      # –ü–æ—Ä–æ–≥ (0.25 –≤–∏–¥–∏—Ç –∏ —è–≤–Ω–æ–µ, –∏ —Å–∫—Ä—ã—Ç–æ–µ)

# –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ (–£–ª—É—á—à–µ–Ω–∏–µ "–∑—Ä–µ–Ω–∏—è")
DETECTOR_CLAHE_CLIP = 3.0   # –°–∏–ª–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
DETECTOR_CLAHE_GRID = 8
DETECTOR_USE_TTA = False    # TTA –≤—ã–∫–ª—é—á–µ–Ω–æ (YOLO-Seg –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
IS_CLAHE_DETECT = True

# –û—á–∏—Å—Ç–∫–∞ (LaMa)
LAMA_MODEL_NAME = "big-lama"
CLEANER_MASK_DILATION = 6   # –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –º–∞—Å–∫–∏ –Ω–∞ 6px –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

# ==============================================================================
# ‚öôÔ∏è –°–ò–°–¢–ï–ú–ê
# ==============================================================================
DEVICE = "cuda" if torch.cuda.is_available() else "cpu"

def setup_directories():
    for path in [INPUT_DIR, OUTPUT_DIR, LOG_DIR, MODELS_DIR, TRAIN_DATASET_DIR, BACKGROUNDS_DIR, TEMP_DIR]:
        path.mkdir(parents=True, exist_ok=True)

setup_directories()